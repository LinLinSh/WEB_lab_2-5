<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Запись на прием - Медицинский центр</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📅 Запись на прием</h1>
            <p>Заполните форму для записи к врачу</p>
        </div>
        
        <div class="content">
            <div class="card">
                <form action="process_appointment.php" method="POST">
                    <div class="form-group">
                        <label for="patient_name">👤 ФИО пациента:</label>
                        <input type="text" id="patient_name" name="patient_name" required placeholder="Введите ваше полное имя">
                    </div>
                    
                    <div class="form-group">
                        <label for="patient_phone">📞 Телефон для связи:</label>
                        <input type="tel" id="patient_phone" name="patient_phone" required placeholder="+7 (XXX) XXX-XX-XX">
                    </div>
                    
                    <div class="form-group">
                        <label for="doctor_id">👨‍⚕️ Выберите врача:</label>
                        <select id="doctor_id" name="doctor_id" required>
                            <option value="">-- Выберите врача --</option>
                            <?php
                            try {
                                $pdo = new PDO(''mysql:host=db;dbname=clinic_db'', ''clinic_user'', ''clinic_pass'');
                                $pdo->exec("SET NAMES ''utf8mb4''");
                                $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
                                
                                $sql = "SELECT * FROM doctors WHERE status = ''active'' ORDER BY name";
                                $stmt = $pdo->query($sql);
                                $doctors = $stmt->fetchAll(PDO::FETCH_ASSOC);
                                
                                foreach ($doctors as $doctor) {
                                    echo "<option value=''{$doctor[''id'']}''>{$doctor[''name'']} - {$doctor[''specialization'']}</option>";
                                }
                            } catch(PDOException $e) {
                                echo "<option value=''>Ошибка загрузки врачей</option>";
                            }
                            ?>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="appointment_date">📅 Дата приема:</label>
                        <input type="date" id="appointment_date" name="appointment_date" required min="<?php echo date(''Y-m-d''); ?>">
                    </div>
                    
                    <div class="form-group">
                        <label for="appointment_time">⏰ Время приема:</label>
                        <select id="appointment_time" name="appointment_time" required>
                            <option value="">-- Выберите время --</option>
                            <option value="09:00">09:00</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="12:00">12:00</option>
                            <option value="14:00">14:00</option>
                            <option value="15:00">15:00</option>
                            <option value="16:00">16:00</option>
                            <option value="17:00">17:00</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="symptoms">📝 Жалобы и симптомы:</label>
                        <textarea id="symptoms" name="symptoms" rows="4" placeholder="Опишите ваши жалобы и симптомы..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-success">✅ Записаться на прием</button>
                </form>
            </div>
            
            <div class="nav-links">
                <a href="index.php" class="btn btn-secondary">🏠 На главную</a>
                <a href="appointments.php" class="btn">📋 Все записи</a>
            </div>
        </div>
    </div>
    
    <script>
        // Установка минимальной даты как сегодня
        const today = new Date().toISOString().split(''T'')[0];
        document.getElementById(''appointment_date'').min = today;
    </script>
</body>
</html>
